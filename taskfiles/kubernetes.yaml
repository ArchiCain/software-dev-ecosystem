version: '3'

tasks:
  nginx-ingress-install:
    desc: "Install Nginx Ingress Controller"
    cmds:
      - helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
      - helm repo update
      - helm install nginx-ingress ingress-nginx/ingress-nginx

  add-etc-host-entries:
    desc: "Add entries used by ingress to etc/host"
    cmds:
      - ./scripts/update-etc-host.sh

  apply:
    desc: "Apply Kubernetes resources"
    cmds:
      - kubectl apply -f kubernetes/
  
  delete:
    desc: "Delete Kubernetes resources"
    cmds:
      - kubectl delete -f kubernetes/

  tilt:up:
    desc: "Start Tilt using the Tiltfile in the kubernetes directory"
    cmds:
      - tilt up --file kubernetes/common/Tiltfile

  get-pods:
    desc: "List the kubernetes pods"
    cmds:
      - kubectl get pods 